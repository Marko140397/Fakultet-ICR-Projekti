<html lang="en">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta charset="UTF-8">
    <!-- CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <!-- jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!-- JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <!-- JavaScript -->
    <script src="js/bootstrap.min.js"></script>
    <!-- Add icon library -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">


    <title>Register</title>
</head>

<body>

    <nav class='navbar sticky-top navbar-expand-md navbar-light bg-white row shadow' id="divnav">

        <!--   Menu toggle    -->
        <button class="navbar-toggler ml-4" data-toggle="collapse" data-target="#divinnav">
            <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Location indicator mobile -->
        <div class="d-block d-md-none">
            <a class="navbar-brand mb-0 h1" href="#" id="locind">
                Signup
            </a>
        </div>

        <!-- NavBrand Desktop  -->
        <div class="col-3 d-none d-md-block pl-4" style="padding:5px">
            <a class="navbar-brand" href="home.html" id="brandlogo">
                <img class="rounded" src="images/Logo.png">
            </a>
            <a class="navbar-brand mb-0 h1 ml-3" href="home.html" id="brandlogo">
                MovieThtr
            </a>
        </div>

        <!-- NavBrand  Mobile -->
        <div class="d-block d-md-none">
            <a class="navbar-brand" href="home.html" id="brandlogo">
                <img class="rounded" style="width:65px; height:40px" src="images/Logo.png">
            </a>
        </div>

        <!-- Empty div to center logo in mobile -->
        <div class="d-block d-md-none">
            <a class="navbar-brand mb-0 text-white d-block d-md-none" id="locindempty">
                Signup
            </a>
        </div>

        <!-- Account Mobile -->
        <div class="mr-4 d-block d-md-none">
            <a id="logMobile" href="login.html" class="btn" style="font-size: 30" id="locindempty">
                <i class="fa fa-user-circle" aria-hidden="true"></i>
            </a>
        </div>

        <!-- Menu items -->
        <div class='col-6 collapse navbar-collapse row px-0 ml-5' id='divinnav'>
            <ul class="col-12 navbar-nav row px-0" id='navitemholder'>
                <li class="nav-item col-2">
                    <a class="nav-link text-dark" href="home.html" id="navbarDropdown" role="button"
                        aria-haspopup="true" aria-expanded="false">
                        Home
                    </a>
                </li>

                <li class="col-3 nav-item dropdown px-2">
                    <a class="nav-link dropdown-toggle text-dark" href="#" id="navbarDropdown" role="button"
                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Categories
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <a class="dropdown-item" href="allMovies.html">All Categories</a>

                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="allMovies.html?category=Action">Action</a>
                        <a class="dropdown-item" href="allMovies.html?category=Romance">Romantic</a>
                        <a class="dropdown-item" href="allMovies.html?category=SuperHero">Superhero</a>
                        <a class="dropdown-item" href="allMovies.html?category=Comedy">Comedy</a>
                        <a class="dropdown-item" href="allMovies.html?category=Drama">Drama</a>
                    </div>
                </li>
                <li class="col-3 nav-item dropdown px-2">
                    <a class="nav-link dropdown-toggle text-dark" href="#" id="navbarDropdown" role="button"
                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Locations
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <a class="dropdown-item" href="locations.html?location=Belgrade">Belgrade</a>
                        <a class="dropdown-item" href="locations.html?location=Kragujevac">Kragujevac</a>
                        <a class="dropdown-item" href="locations.html?location=Kraljevo">Kraljevo</a>
                        <a class="dropdown-item" href="locations.html?location=Novi sad">Novi sad</a>
                        <a class="dropdown-item" href="locations.html?location=Nis">Nis</a>
                        <a class="dropdown-item" href="locations.html?location=Pristina">Pristina</a>
                        <a class="dropdown-item" href="locations.html?location=Subotica">Subotica</a>
                    </div>
                </li>
                <li class="col-3 nav-item px-2">
                    <a class="nav-link text-dark" href="aboutUs.html" id="navbarDropdown" role="button"
                        aria-haspopup="true" aria-expanded="false">
                        About us
                    </a>
                </li>
            </ul>
        </div>


        <!-- Register Desktop -->
        <div id="registerdiv" class="col-3 d-none  text-center ">
            <a class="btn mr-4" style="font-size: 1.2vw;" href="login.html" id="locindempty">
                Sign in
            </a>

        </div>
        <!-- Logged in Desktop -->
        <div id="loggeddiv" class="col-3 d-none d-md-block text-center">
            <a class="btn" style="font-size: 30" id="iconAccount">
                <i class="fa fa-user-circle" aria-hidden="true"></i>
            </a>
            <a class="btn mr-4" id="accountName">
                User1234
            </a>
        </div>

    </nav>



    <!-- Page body -->
    <div class="container-fluid my-4 mx-0 px-0 pr-0 justify-content-center" id="pageBody">

        <!-- Heading -->
        <div class="text-center d-none d-md-block mb-4" id="heading">
            <h2 style="font-size: 2.5vw">Register</h2>
        </div>
        <!-- Heading Mobile-->
        <div class="text-center d-block d-md-none mb-4" id="heading">
            <h2>Register</h2>
        </div>




        <div class="row justify-content-center">
            <!-- Fields Div Credit -->
            <div class="col-md-6 col-11 justify-content-center text-center" id="loginDiv">
                <form class="needs-validation text-left" action="home.html" novalidate>
                    <input id="hiddenUser" type="hidden" name="user" value="false">

                    <div class="form-row">
                        <div class="form-group col-md-4 col-12">
                            <label for="inputUsername">Username</label>
                            <input type="text" class="form-control" id="inputUsername" placeholder="Username" required>
                            <div class="invalid-feedback">
                                Please enter your username.
                            </div>
                        </div>
                        <div class="form-group col-md-8 col-12">
                            <label for="inputEmail">Email</label>
                            <input type="email" class="form-control" id="inputEmail" placeholder="email@gmail.com"
                                required>
                            <div class="invalid-feedback">
                                Please enter a valid email.
                            </div>
                        </div>

                    </div>

                    <div class="form-row ">
                        <div class="form-group col-md-6 col-12"">
                            <label for=" inputPassword">Password</label>
                            <input type="password" class="form-control" id="inputPassword" placeholder="Password"
                                required>
                            <div class="invalid-feedback">
                                Please enter your password.
                            </div>
                        </div>

                    </div>
                    <div class="form-row ">
                        <div class="form-group col-md-6 col-12"">
                                    <label for=" inputPassword2">Repeat password</label>
                            <input type="password" class="form-control" id="inputPassword2"
                                placeholder="Repeat Password" required>
                            <div class="invalid-feedback">
                                The passwords don't match.
                            </div>
                        </div>

                    </div>


                    <div class="form-row">
                        <div id="inputSelect" class="col-md-6 col-12 ">
                            <label for="inputSelect">Favourite theatre</label>
                            <select id="inputState" class="form-control" required>

                                <option>New Belgrade Theatre</a>
                                <option>Trg Republike Theatre</a>
                                <option>Zemun Theatre</a>

                                <option>Kragujevac Theatre</a>

                                <option>Kraljevo Theatre</a>

                                <option>Novi sad Theatre</a>

                                <option>Nis Theatre</a>

                                <option>Pristina Theatre</a>

                                <option>Subotica Theatre</a>
                            </select>
                        </div>

                        <div class="form-group col-md-6 col-12"">
                                <label for=" inputPhone">(Optional) Phone</label>
                            <input type="text" class="form-control" id="inputPassword2" placeholder="123 111 222"
                                pattern="[0-9_].{8,}" maxlength="12">
                            <div class="invalid-feedback">
                                Enter valid phone number
                            </div>
                        </div>
                    </div>


                    <div class="row justify-content-center mt-3">
                        <div class="col-6">
                            <button type="submit" class="btn btn-block btn-danger">Register</button>
                        </div>

                    </div>

                </form>



            </div>
        </div>

    </div>

    <script>
        $(document).ready(function () {

            // VALIDATION
            // Fetch all the forms we want to apply custom Bootstrap validation styles to
            var forms = document.getElementsByClassName('needs-validation');
            // Loop over them and prevent submission
            var validation = Array.prototype.filter.call(forms, function (form) {
                form.addEventListener('submit', function (event) {
                    if (form.checkValidity() === false ) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    $("#hiddenUser").attr('value', $("#inputUsername").val());
                    form.classList.add('was-validated');
                }, false);
            });

            function validatePassword(password,confirm_password) {
                if (password.value !== confirm_password.value) {
                    confirm_password.attr('class','is-invalid form-control');
                    return false;
                } else {
                    confirm_password.attr('class','is-valid form-control');
                    return true;
                }
            }

            function getUrlVars() {
                var vars = {};
                var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function (m, key, value) {
                    vars[key] = value;
                });
                return vars;
            }

            $('#inputPassword').keyup(function(){
                $('#inputPassword2').attr("pattern",$(this).val());
            });

            function getUrlParam(parameter, defaultvalue) {
                var urlparameter = defaultvalue;
                if (window.location.href.indexOf(parameter) > -1) {
                    urlparameter = getUrlVars()[parameter];
                }
                return urlparameter;
            }

            // Logged in check
            jQuery(function ($) {
                var check = getUrlParam('user', 'false');

                if (check === 'false') {
                    loginChange(false, check);
                } else {
                    loginChange(true, check);
                }


            });

            function loginChange(logged, user) {
                if (logged) {
                    $('#registerdiv').attr('class', 'col-3 d-none  text-center');
                    $('#loggeddiv').attr('class', 'col-3 d-none d-md-block text-center');
                    $('#accountName').text(user);
                    changeHrefs(user);
                } else {
                    $('#registerdiv').attr('class', 'col-3 d-none d-md-block text-center');
                    $('#loggeddiv').attr('class', 'col-3 d-none text-center');
                }
            }

            function changeHrefs(user) {

                $('a').each(function () {
                    let element = $(this);
                    let href = element.attr('href');

                    if (href !== undefined && href !== "#" && href !== "#cashFieldDiv" && href !==
                        "#creditFieldDiv") {
                        if (href.indexOf('?') > -1) {
                            element.attr('href', href + "&user=" + user);
                        } else {
                            element.attr('href', href + "?user=" + user);
                        }
                    }
                });

            }





        });
    </script>
</body>

</html>